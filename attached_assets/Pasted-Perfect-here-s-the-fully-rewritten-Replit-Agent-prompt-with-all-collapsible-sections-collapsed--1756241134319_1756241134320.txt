Perfect ðŸ‘ â€” hereâ€™s the fully rewritten Replit Agent prompt with all collapsible sections collapsed by default (including Reproductive Context). Everything else stays intact.

â¸»

REPLIT AGENT PROMPT: Profile-page US/SI Toggle (store canonically in US, ISO alpha-2 country)

â¸»

Task

Add a single unit toggle on the Profile page only (â€œUS / SI (metric)â€) that controls how height and weight inputs are shown:
	â€¢	US â†’ height in ft/in, weight in lb
	â€¢	SI â†’ height in cm, weight in kg

All values must be stored canonically in US units in the database. Country must be ISO alpha-2 (e.g., US, CA, GB).

â¸»

Requirements

UI (Profile page only)
	â€¢	Add a UnitSystemToggle control near the top of the Profile page (not global).
	â€¢	Place Country of Residence dropdown directly below the toggle (ISO alpha-2 list).
	â€¢	Toggle options: US / SI (metric).
	â€¢	When toggled:
	â€¢	Show either ft/in or cm (not both).
	â€¢	Show either lb or kg (not both).
	â€¢	Inputs use placeholders only (no defaults). Allow clearing to empty (NULL).
	â€¢	Keep Majestic aesthetic: calm, modern, no animations.
	â€¢	All profile sections (Demographics, Chronic Conditions, Allergies & Intolerances, Lifestyle, Reproductive Context) must be collapsible and collapsed by default.

â¸»

Behavior
	â€¢	On load: read preferred_unit_system from /api/profile and render fields accordingly.
	â€¢	On toggle: convert current in-memory values and re-render inputs in the selected system.
	â€¢	On save:
	â€¢	Convert SI inputs â†’ US on the client.
	â€¢	Send canonical fields only:

{
  "preferred_unit_system": "US" | "SI",  // string enum
  "height_in": 69,                       // INT (total inches) or null
  "weight_lb": 165.00,                   // DECIMAL(6,2) or null
  "country_of_residence": "US"           // ISO alpha-2
}

	â€¢	Height in US mode: height_in = ft * 12 + in (in constrained 0â€“11).
	â€¢	Height in SI mode: height_in = round(cm / 2.54).
	â€¢	Weight in SI mode: weight_lb = kg * 2.2046226218.

â¸»

API / Storage
	â€¢	GET /api/profile returns:

{
  "preferred_unit_system": "US",
  "height_in": 69,
  "weight_lb": 165.0,
  "country_of_residence": "US"
}

	â€¢	PUT /api/profile accepts canonical US fields + unit preference + country.
	â€¢	DB schema additions:

users.preferred_unit_system VARCHAR(2) NOT NULL DEFAULT 'US',
users.height_in INT NULL,
users.weight_lb DECIMAL(6,2) NULL,
users.country_of_residence VARCHAR(2)  -- ISO alpha-2


â¸»

Validation (MVP)
	â€¢	height_in hard bounds: 48â€“90 (4â€™0â€â€“7â€™6â€); soft-warn outside 55â€“80.
	â€¢	Inches field: constrained 0â€“11 (no auto-carry).
	â€¢	weight_lb hard bounds: 66â€“660; soft-warn outside 90â€“440.
	â€¢	Allow NULL (cleared field). Never store 0.
	â€¢	Ensure country_of_residence is valid ISO alpha-2 code.
	â€¢	Use exact conversion constants; rounding only for UI display, not for stored values.

â¸»

Constraints
	â€¢	Affect Profile page only (no global header toggle).
	â€¢	Do not add analytics or extra fields.
	â€¢	Preserve input labels/focus when toggling unit system.
	â€¢	All sections collapsed by default: Demographics, Chronic Conditions, Allergies & Intolerances, Lifestyle, Reproductive Context.

â¸»

QA Checklist
	â€¢	Toggle US â‡„ SI: inputs switch correctly, values converted without drift.
	â€¢	Enter 175 cm â†’ Save â†’ reload in US â†’ â‰ˆ 5 ft 9 in.
	â€¢	Enter 154 lb â†’ Save â†’ toggle to SI â†’ â‰ˆ 69.9 kg.
	â€¢	Clearing values saves NULL; reload shows empty placeholders.
	â€¢	Inches field rejects >11; no auto-carry.
	â€¢	Invalid country code cannot be saved; dropdown only shows valid ISO alpha-2.
	â€¢	Out-of-range entries trigger gentle warning and block save.
	â€¢	All collapsible sections load collapsed by default, expand smoothly on click.
	â€¢	No styling regressions; Profile page retains Majestic aesthetic.

â¸»

âœ… This is now airtight: one toggle, canonical US storage, ISO alpha-2 countries, and every profile section collapsed by default.

â¸»

Would you like me to also adjust the Profile navigation flow so that when the user opens Profile for the first time, Demographics auto-expands once (to encourage completion), but defaults to collapsed on later visits?